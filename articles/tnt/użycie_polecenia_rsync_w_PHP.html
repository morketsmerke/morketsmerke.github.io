<!DOCTYPE html>
	<html>
		<head>
			<meta charset="utf-8" />
			<link rel="icon" type="image/png" href="https://i.ibb.co/khy45hh/mm.png">
			<style>
				.code-block {
					display: block;
					background-color: silver;
					font-family: monospace;
					font-weight: bolder;
				}
				.code-inline {
					background-color: silver;
					font-family: monospace;
					font-weight: bolder;
				}
				p { text-align: justify; }
			</style>
		</head>


		<body style="font-family: monospace;" >
<pre>
  _______            ___   ______     _      __
 /_  __(_)___  _____( _ ) /_  __/____(_)____/ /_______
  / / / / __ \/ ___/ __ \/|/ / / ___/ / ___/ //_/ ___/
 / / / / /_/ (__  ) /_/  &lt;/ / / /  / / /__/ ,&lt; (__  )
/_/ /_/ .___/____/\____/\/_/ /_/  /_/\___/_/|_/____/
     /_/
</pre>

		<p style="margin: 15px; padding: 0; outline: 0; font-size: 18pt;">
			&#9760;&nbsp;<a href="https://morketsmerke.github.io/">morketsmerke</a>&nbsp;&#9760;
		</p>

		<div style="margin-left: auto; margin-right: auto; width: 80%;">
      <h1 style="text-align: center;">Użycie polecenia rsync w PHP</h1>
		  <p>
			  Użyć polecenia rsync możemy za pomocą instrukcji 
        <code class="code-inline">exec()</code>, wartością zwracaną przez tą 
        instrukcje są dane wyjściowe polecenia.
		  </p>
		  <p>
			  W celu uruchomienia polecenia <code class="code-inline">rsync</code>, 
        należy pamiętać o wymianie kluczy między stronami oraz o tym aby 
        użytkownik <em>www-data</em> posiadał w swoim katalogu domowym 
        (zazwyczaj <em>/var/www</em>) katalog <em>.ssh</em> z kluczami. Katalog
        ten powinien mieć ustawionego właściciela na <em>www-data</em> oraz 
        odpowienie uprawnienia (<em>644</em>, dla katalogu, <em>600</em> dla 
        klucza prywatnego [plik bez rozszerzenia .pub]). Warto również użyć 
        kilku opcji SSH (przez SSH <code class="code-inline">rsync</code> 
        łączy się z serwerem) takich jak 'StrictHostKeyChecking' ustawione na 
        'no' (<code class="code-inline">StrictHostKeyChecking=no</code>) oraz 
        'UserKnowHostFile' ustawione na <em>/dev/null</em> 
        (<code class="code-inline">UserKnownHostsFile=/dev/null</code>)
			  Aby w ogóle użyć opcji SSH w <code class="code-inline">rsync</code>, 
        należy użyć przełącznika <code class="code-inline">-e</code> jako 
        wartość tej opcji w podwójnych apostrofach podaje się polecenie 
        <code class="code-inline">ssh</code> gdzie, każdą z opcji podaje się 
        po przełączniku <code class="code-inline">-o</code>.
		  </p>
<pre class="code-block">
exec('rsync -re \"ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null\" &lt;katalog_lokalny&gt; &lt;użytkownik_zdalny&gt;@&lt;adres_ip_serwera&gt;:&lt;katalog_zdalny&gt;');
</pre>
      <p>
        ~xf0r3m
      </p>
		</div>
		<p style="margin: 15px; padding: 0; outline: 0;">
			2022; COPYLEFT; ALL RIGHTS REVERSED;
		</p>
		</body>
	</html>
